from reportlab.lib.pagesizes import letter
from reportlab.pdfgen.canvas import Canvas
from reportlab.pdfbase import pdfmetrics
from reportlab.pdfbase.ttfonts import TTFont

import base64
import sys
import tempfile

from optparse import OptionParser
import os, subprocess
from PyQt6.QtGui import QColor

attribution = False

if len(sys.argv)<2:
    from PyQt6.QtWidgets import (
    QApplication, QWidget, QGridLayout, QLabel, QComboBox,
    QLineEdit, QSpinBox, QPushButton, QMessageBox
    )
    from PyQt6.QtGui import QColor
    #from PyQt6.QtCore import 

def parse_range(astr, prefix=""):
    result = []
    width = 6 - len(prefix)

    if width <= 0:
        raise ValueError("Prefix length must be less than 6")

    for part in astr.split(','):
        start, end = map(int, part.split('-'))
        for i in range(start, end + 1):
            num = str(i)
            if len(num) > width:
                raise ValueError(f"Number '{i}' exceeds available width")
            s = f"{prefix}{num.zfill(width)}"
            result.append(s)

    return result

def makelabels(stream, gen, labels, off):
    with tempfile.NamedTemporaryFile(delete=False, suffix=".ttf") as tmp_font:
        tmp_font.write(base64.b64decode(fontdata))
        tmp_font_path = tmp_font.name
    pdfmetrics.registerFont(TTFont('3of9', tmp_font_path))
    os.remove(tmp_font_path)

    canvas=Canvas(stream, pagesize=letter)
    width, height=letter

    LABEL_WIDTH = 3 * 72 # 3 inches
    LABEL_HEIGHT = (5 * 72) / 8 # 5/8 inch
    CHAR_WIDTH = 25
    CHAR_HEIGHT = 13
    NUMBER_OFFSET = 20
    BARCODE_OFFSET = 30 #from right
    TOP_OFFSET= (72 / 2) + 4  # 0.5 inch plus some padding due to printer issues
    LEFT_OFFSET= 50
    HORIZ_SPACING = 72
    VERT_SPACING = 0
    MARGIN=2
    
    colors="red", "yellow", "lightgreen", "lightblue", "grey", "orange", "hotpink", "chartreuse", "darkorange", "magenta"

    canvas.setFont("Helvetica", 10)
    canvas.setFillColor("black")
    if attribution:
        canvas.drawString(125, height-15, "Print at 100% scale onto Avery labels 6577")
        canvas.setFillColor("blue")
        canvas.drawString(165, height-30, "Generated using PyLTO")
        #canvas.linkURL("http://www.manicsoftware.co.uk", (150, height-40, width-150, height-10))
    canvas.setFillColor("black")

    labels_per_page = 32
    total_labels = len(labels)
    current_index = 0

    while current_index < total_labels:
        # Select 32 labels for the current page
        page_labels = labels[current_index:current_index + labels_per_page]
        page_offset = off if current_index == 0 else 0

        for i, label_number in enumerate(page_labels):
            label_index = i + page_offset

            if label_index >= 32:
                continue  # skip labels that fall off the page due to offset

            column = label_index // 16  # 0 or 1
            row = label_index % 16

            x_pos = column * (LABEL_WIDTH + HORIZ_SPACING) + LEFT_OFFSET
            y_pos = height - LABEL_HEIGHT - row * (LABEL_HEIGHT + VERT_SPACING) - TOP_OFFSET

            # Draw barcode
            #barcode = "*{0:06d}L{1}*".format(int(label_number), gen)
            barcode = "*{0:06}L{1}*".format(label_number, gen)
            canvas.setFont("3of9", 42)
            canvas.scale(-1.0, 1.0)
            canvas.drawString(-(x_pos + LABEL_WIDTH - BARCODE_OFFSET), y_pos + MARGIN, barcode)
            canvas.scale(-1.0, 1.0)

            # Draw colored number boxes
            #label_str = "{0:06d}".format(int(label_number))
            label_str = "{0:06}".format(label_number)
            gen_label = "L" + str(gen)
            canvas.setFont("Helvetica-Bold", 13)

            for digit_index, char in enumerate(label_str):
                if not char.isdigit():
                    canvas.setFillColor("white")
                else:
                    canvas.setFillColor(colors[int(char)])
                canvas.rect(x_pos + digit_index * CHAR_WIDTH + NUMBER_OFFSET,
                            y_pos + LABEL_HEIGHT - CHAR_HEIGHT - MARGIN,
                            CHAR_WIDTH, CHAR_HEIGHT, fill=1)
                canvas.setFillColor("black")
                canvas.drawString(x_pos + digit_index * CHAR_WIDTH + 7 + NUMBER_OFFSET,
                                  y_pos + 2 + LABEL_HEIGHT - CHAR_HEIGHT - MARGIN,
                                  char)

            # Draw generation box
            canvas.setFont("Helvetica-Bold", 9)
            canvas.setFillColor("white")
            canvas.rect(x_pos + digit_index * CHAR_WIDTH + CHAR_WIDTH + NUMBER_OFFSET,
                        y_pos + LABEL_HEIGHT - CHAR_HEIGHT - MARGIN,
                        CHAR_WIDTH, CHAR_HEIGHT, fill=1)
            canvas.setFillColor("black")
            canvas.drawString(x_pos + digit_index * CHAR_WIDTH + CHAR_WIDTH + 6 + NUMBER_OFFSET,
                              y_pos + 3 + LABEL_HEIGHT - CHAR_HEIGHT - MARGIN,
                              gen_label)

        canvas.showPage()
        # Move to the next set of 32 labels, loop will exit if no more labels
        current_index += labels_per_page - (off if current_index == 0 else 0)
        
    canvas.showPage()
    canvas.save()


'''
Execute when Go button pressed
'''
def gobutton():
    global gui
    global gen
    global numbers
    global offset

    numlist=str(numbers.displayText()).split(" ")
    try:
        labels=parse_range(",".join(numlist), prefix.text())
    except:
        QMessageBox.critical(gui, 'PyLTO', "Number Range Invalid")
        return
    print(labels)
    print(prefix.text())

    _,tmpfilename=tempfile.mkstemp(".pdf")
    file=open(tmpfilename, 'wb')
    makelabels(file, int(gen.currentText()), labels, offset.value())
    file.close()

    if sys.platform.startswith('darwin'):
        subprocess.call(('open', tmpfilename))
    elif os.name == 'nt':
        os.startfile(tmpfilename)
    elif os.name == 'posix':
        subprocess.call(('xdg-open', tmpfilename))

def main():

    if len(sys.argv)<2:
        global gui
        global gen
        global numbers
        global offset
        global prefix

        ### Setup GUI
        app = QApplication(sys.argv)
        gui = QWidget()
        gui.setWindowTitle("PyLTO")
        layout = QGridLayout(gui)
        genlabel = QLabel("LTOGeneration", gui)
        layout.addWidget(genlabel, 0, 0)
        
        gen = QComboBox(gui)
        for i in range(10):
            gen.addItem(str(i+1))
        gen.setCurrentIndex(3)
        layout.addWidget(gen, 0, 1)

        prefixlabel = QLabel("Prefix", gui)
        layout.addWidget(prefixlabel, 1, 0)
        prefix = QLineEdit("", gui)
        prefix.setPlaceholderText("e.g. LTO")
        print(prefix.text())
        layout.addWidget(prefix, 1, 1)

        numlabel = QLabel("Numbers", gui)
        layout.addWidget(numlabel, 2, 0)

        numbers=QLineEdit(gui)
        layout.addWidget(numbers, 2, 1)

        offlabel = QLabel("Offset", gui)
        layout.addWidget(offlabel, 3, 0)

        offset = QSpinBox(gui)
        offset.setRange(0, 31)
        layout.addWidget(offset, 3, 1)
        button = QPushButton("Go", gui)
        button.clicked.connect(gobutton)
        layout.addWidget(button, 4, 0, 1, 2)
        gui.show()
        return app.exec()
    else:
        parser=OptionParser(usage="%prog [options] numbers (e.g. 1-5,6,7,8 9-12)\nRun without options to launch UI (you'll need the pyqt4 libraries)")
        parser.add_option("-g", "--generation", dest="generation",
                          help="tape generation (defaults to 4)", type=int, default=4)
        parser.add_option("-o", "--offset", dest="offset",
                          help="skip the first 'offset' labels", type=int, default=0)
        (opts, args)=parser.parse_args()
        gen=int(opts.generation)
        off=int(opts.offset)
        
        if len(args)<1:
            sys.exit("Going to need some numbers here mate")
        labels=parse_range(",".join(args))
        if len(labels)>(32-off):
            sys.exit("Only 32 labels will fit on a page")
        
        makelabels(sys.stdout, gen, labels, off)


fontdata= \
"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" + \
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAY" + \
"AD8AZgCNALQA2wEDASsBUgF5AaEByAHvAhcCPwJnAo8CtgLcAwMDKwNTA3oDogPJA/EEGQRBBGgE" + \
"jwS3BN4FBQUsBVMFegWhBcgF8AYYBkAGZgaNBrQG2wABAAAALwAUAAUAAAAAAAEAAAAAAAAAAAAA" + \
"AAAAAAABAAAAEADGAAEAAAAAAAAACQEoAAEAAAAAAAEAAwEPAAEAAAAAAAIABwD6AAEAAAAAAAMA" + \
"AwC3AAEAAAAAAAQAAwCOAAEAAAAAAAUADABqAAEAAAAAAAYAAwBXAAEAAAAAAAcACQAAAAMAAQQJ" + \
"AAAAbgExAAMAAQQJAAEAFgESAAMAAQQJAAIADgEBAAMAAQQJAAMAQAC6AAMAAQQJAAQAJgCRAAMA" + \
"AQQJAAUAGAB2AAMAAQQJAAYAEABaAAMAAQQJAAcATgAJVHJhZGVtYXJrAEYAcgBlAGUAIAAzACAA" + \
"bwBmACAAOQCZACAAVAByAGEAZABlAG0AYQByAGsAIABvAGYAIABNAGEAdAB0AGgAZQB3ACAAVwBl" + \
"AGwAYwBoTmV3AEYAcgBlAGUAMwBvAGYAOVZlcnNpb24gMS4wMABWAGUAcgBzAGkAbwBuACAAMQAu" + \
"ADAAMU5ldwBGAHIAZQBlACAAMwAgAG8AZgAgADkAIABSAGUAZwB1AGwAYQByTmV3AEYAcgBlAGUA" + \
"IAAzACAAbwBmACAAOQAgAFIAZQBnAHUAbABhAHIAOgBWAGUAcgBzAGkAbwBuACAAMQAuADAAMVJl" + \
"Z3VsYXIAUgBlAGcAdQBsAGEAck5ldwBGAHIAZQBlACAAMwAgAG8AZgAgADlDb3B5cmlnaHQAQwBv" + \
"AHAAeQByAGkAZwBoAHQAIACpACAAMQA5ADkANwAgAGIAeQAgAE0AYQB0AHQAaABlAHcAIABXAGUA" + \
"bABjAGgALgAgAEEAbABsACAAUgBpAGcAaAB0AHMAIABSAGUAcwBlAHIAdgBlAGQALgAAAAAAAAAA" + \
"AAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="

if __name__ == '__main__':
   main()
